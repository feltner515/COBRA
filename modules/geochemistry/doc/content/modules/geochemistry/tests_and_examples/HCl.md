# An acidic solution

A particularly simple `geochemistry` example involves computing the molality, etc, of species in an acidic solution with fixed pH.

## The MOOSE input file: step 1

The database and basis species must be specified for all `geochemistry` simulations.  In this case, the full `moose_geochemdb.json` database is used, and the basis species are simply H$_{2}$O, H$^{+}$ and Cl$^{-}$.  A piecewise linear interpolation for the equilibrium constants and the Debye-Huckel activity coefficients is used so that the result agrees exactly with the analogous GWB simulation:

!listing modules/geochemistry/test/tests/equilibrium_models/HCl.i block=UserObjects

## The MOOSE input file: step 2

The next piece of the input file involves specifying the initial conditions and the simulation type.  This is a time-independent solve (just the equilibrium configuration is sought).  The charge-balance species is chosen to be Cl$^{-}$, there is 1$\,$kg of solvent water and the pH is fixed to 2 (via `log10activity = -2`):

!listing modules/geochemistry/test/tests/equilibrium_models/HCl.i block=TimeIndependentReactionSolver

## The MOOSE input file: optional step 3

Postprocessors may be used to produce some CSV output.  In this example, all the information is already obtained in the console output, but by way of example, the following postprocessors output the activity of water, the pH, the solvent-water mass, the Cl$^{-}$ molality, etc:

!listing modules/geochemistry/test/tests/equilibrium_models/HCl.i block=Postprocessors

In addition:

!listing modules/geochemistry/test/tests/equilibrium_models/HCl.i block=GlobalParams

!listing modules/geochemistry/test/tests/equilibrium_models/HCl.i block=Outputs


## The equivalent GWB input file

The results may be compared with those generated by [Geochemists Workbench](https://www.gwb.com/).  The GWB input file is

!listing modules/geochemistry/test/tests/equilibrium_models/HCl.rea

## Results

The `geochemistry` module produces the same result as GWB (up to precision):

```
Summary:
Total number of iterations required = 9
Error in calculation = 6.888e-17mol
Charge of solution = 0mol (charge-balance species = Cl-)
Mass of solvent water = 1kg
Mass of aqueous solution = 1kg
pH = 2
Ionic strength = 0.01097mol/kg(solvent water)
Stoichiometric ionic strength = 0.01097mol/kg(solvent water)
Activity of water = 0.9996
Temperature = 25

Basis Species:
H+;  bulk_moles = 0.01097mol;  bulk_conc = 11.05mg/kg(solution);  molality = 0.01097mol/kg(solvent water);  free_conc = 11.06mg/kg(solvent water);  act_coeff = 0.9114;  log10(a) = -2
Cl-;  bulk_moles = 0.01097mol;  bulk_conc = 388.8mg/kg(solution);  molality = 0.01097mol/kg(solvent water);  free_conc = 389mg/kg(solvent water);  act_coeff = 0.8956;  log10(a) = -2.008

Equilibrium Species:
HCl;  molality = 7.805e-11mol/kg(solvent water);  free_conc = 2.846e-06mg/kg(solvent water);  act_coeff = 1;  log10(a) = -10.11;  HCl = 1*H+ + 1*Cl-;  log10K = 6.1
OH-;  molality = 1.149e-12mol/kg(solvent water);  free_conc = 1.954e-08mg/kg(solvent water);  act_coeff = 0.8971;  log10(a) = -11.99;  OH- = 1*H2O - 1*H+;  log10K = 13.99
```

## Without an Action

Although most users will want to use the Action system, it is possible to build all `geochemistry` models without using Actions for slightly more fine-grained control.  The equivalent input file is:

!listing modules/geochemistry/test/tests/equilibrium_models/HCl_no_action.i

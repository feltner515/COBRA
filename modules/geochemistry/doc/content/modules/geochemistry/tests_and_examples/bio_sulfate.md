# Biogeochemistry with a sulfate reducer

This follows the example in Section 18.5 of [!cite](bethke_2007).  Suppose that a sulfate-reducing microbe acts in the presence of acetate (CH$_{3}$COO$^{-}$) to catalyse the reaction
\begin{equation}
\label{sulfate_reduction.eqn}
\mathrm{CH}_{3}\mathrm{COO}^{-} + \mathrm{SO}_{4}^{2-} \rightarrow 2 \mathrm{HCO}_{3}^{-} + \mathrm{HS}^{-} \ .
\end{equation}
Bethke details the initial composition of the aqueous solution for this problem.  Most important for this example are the initial bulk composition of the acetate, which is $10^{-3}$ moles, the initial bulk composition of sulfate, which is large, and the initial mass of the sulfate reducer, which is 0.1$\,$mg.

In this example, microbe mortality is unimportant.  For each mole turnover of this reaction, Bethke estimates the microbe mass increases by $4.3\,$g.

The [rate](GeochemistryKineticRate.md) of [sulfate_reduction.eqn] is assumed to be of the form
\begin{equation}
\label{eqn.rr}
r = n_{w}k_{+}C_{\mathrm{biomass}} \frac{m}{m + K_{A}} \left(1 - \left(\frac{Q \exp(45000/RT)}{K} \right)^{1/5} \right) \ .
\end{equation}
where

- $n_{w}$ (units: kg) is the mass of solvent water;
- $k_{+} = 10^{-9}\,$mol.mg$^{-1}$.s$^{-1} = 0.0864\,$mol.g$^{-1}$.day$^{-1}$ is the intrinsic rate constant, where the mass (grams) in the denominator is the mass of microbe, and the direction is forward (dissolution of acetate only, not the reverse);
- $C_{\mathrm{biomass}}$ (units: g.kg$^{-1}$) is the microbe concentration, where the mass (kg) in the denominator is the mass of solvent water;
- $m$ (units: mol.kg$^{-1}$) is the molality of CH$_{3}$COO$^{-}$ (this is the free concentration, not the bulk composition);
- $K_{A} = 70\times 10^{-6}\,$mol.kg$^{-1}$ is the half-saturation constant of the acetate;
- $Q$ is the activity product of [sulfate_reduction.eqn];
- $K$ is the equilibrium constant of [sulfate_reduction.eqn];
- $45000\,$J.mol$^{-1}$ is an estimate of the energy captured by the microbe for each mole turnover of [sulfate_reduction.eqn];
- $R=8.314472\,$J.K$^{-1}$.mol$^{-1}$ is the gas constant;
- $T$ (units: K) is the temperature.

As discussed on the main [biogeochemistry](theory/biogeochemistry.md) page, there are two ways of modelling this scenario:

1. the microbe is treated as a new basis species, and the acetate (CH$_{3}$COO$^{-}$) as a kinetic species that is not an equilibrium with the aqueous solution;
2. the microbe is treated as a kinetic species, and all other species (acetate, etc) are at equilibrium

Input files and results for both of these methods are found below.

## Method 1

Here, the microbe is considered as a primary species.  The aqueous solution as described by Bethke contains a number of ionic species: the important thing here is the existance of `Biomass1` in the `basis_species` list:

!listing modules/geochemistry/test/tests/kinetics/bio_sulfate_1.i block=definition

The `Biomass1` species has a molar mass of $1\,$g.mol$^{-1}$.

The acetate is considered a kinetic species.  [eqn.rr] is implemented using the following [GeochemistryKineticRate](GeochemistryKineticRate.md) UserObject:

!listing modules/geochemistry/test/tests/kinetics/bio_sulfate_1.i block=rate_sulfate_reducer

Most of the values are self-explanatory.  The parameter `direction = dissolution` because the microbe acts to convert acetate into bicarbonate, not the reverse.  Notice the `non_kinetic_biological_catalyst`.  Because one mole of [sulfate_reduction.eqn] produces $4.3\,\mathrm{g} = 4.3\,\mathrm{mol}$ of microbe,

```
non_kinetic_biological_efficiency = 4.3
```

Consider the initial composition.  Above, it is specified that the initial bulk composition of acetate is $10^{-3}$ moles.  It is easy to use the `geochemistry` module to show that the molality of acetate is 0.0008643$\,$mol.kg$^{-1}$ (for instance, remove the `sulfate_reducer` from `bio_sulfate_2.i` mentioned below and use a [TimeIndependentReactionSolver](TimeIndependentReactionSolver/index.md)).  This is the molality that enters into [eqn.rr].  There are two possibilities:

- initialize the kinetic acetate to 0.0008643$\,$moles.  Then the rate is likely to be reasonably accurate, but there won't be as much acetate to react compared with the case when $10^{-3}$ moles are used, so the final biomass will be smaller.
- initialize the kinetic acetate to $10^{-3}$ moles.  Then the rate will be slightly higher than it should be, but the full amount of acetate will react, so the final biomass will be reasonably correct.  This approach is used to generate the graphs below.

This example illustrate the inaccuracies brought about by using the simple approach of treating the biomass as an equilibrium species that is generated by a kinetic reaction.



## Method 2

Here, the microbe is considered as a kinetic species that is generated via [sulfate_reduction.eqn].  The other species (acetate, sulfate, etc) are considered primary species in equilibrium in the aqueous solution.  The standard MOOSE geochemical database contains the required information:

```
    "sulfate_reducer": {
      "species": {
        "CH3COO-": -1.0,
        "SO4--": -1.0,
        "HCO3-": 2.0,
        "HS-": 1.0
      },
      "molar volume": 1,
      "molecular weight": 1E3,
	"logk": [8.502, 8.404, 8.451, 8.657, 9.023, 9.457, 9.917, 10.31]
    },
```

If this entry did not appear in the database, it could be manually entered, but the equilibrium constants would have to be derived from those already in the database (or from experimental measurements).  This is easily done by using the [GeochemicalModelInterogator](GeochemicalModelInterrogator.md):

!listing modules/geochemistry/test/tests/kinetics/bio_sulfate_0.i block=GeochemicalModelInterrogator

and the appropriate model definition:

!listing modules/geochemistry/test/tests/kinetics/bio_sulfate_0.i block=UserObjects

After the entry exists in the database, the model description starts with defining the species present:

!listing modules/geochemistry/test/tests/kinetics/bio_sulfate_2.i block=definition

The `sulfate_reducer` species has a molar mass of $10^{3}\,$g.mol$^{-1}$ in the database file.  It is unimportant that this is definitely incorrect: it is only important to remember this value when entering numerical values for the kinetic rate, below.

[eqn.rr] is implemented using the following [GeochemistryKineticRate](GeochemistryKineticRate.md) UserObject:

!listing modules/geochemistry/test/tests/kinetics/bio_sulfate_2.i block=rate_sulfate_reducer

Most of the values are self-explanatory.  Note:

- `multiply_by_mass = true` means the rate is multiplied by the mass (in grams) of the `sulfate_reducer`, as desired
- there is no need to use H2O in the `promoting_species` because $n_{w}C_{\mathrm{biomass}}$ is just the mass of the `sulfate_reducer` in grams
- `kinetic_biological_efficiency = 4.3E-3` because this is the number of moles of `sulfate_reducer` that is created for one mole [sulfate_reduction.eqn] turnover: recall that its molar mass is $10^{3}\,$g.mol$^{-1}$


## Results

As expected, the two methods differ marginally: see [bio_sulfate.fig].  Method 1 is slightly inaccurate because the full amount of acetate is used in the rate, instead of just the free molality as in method 2.  Method 2 is initialized with the same bulk composition ($10^{-3}$ moles) but some of this is bound into secondary species, which slowly release the acetate into solution in order to react via [sulfate_reduction.eqn].

!media bio_sulfate.png caption=Results of the biologically-catalysed sulfate reduction  id=bio_sulfate.fig








